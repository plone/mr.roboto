<html>
    <head>
        <title>Mr. Roboto</title>
        <style>
            body {
                background-color: rgb(0,149,211);
            }
            #logo {
                width: 100%;
                height: 100%;
                background: url('/static/roboto.png') no-repeat 50% 50%;
            }
            ul {
                list-style-type: none
            }
        </style>
        <script>
             var time = new Date().getTime();
             $(document.body).bind("mousemove keypress", function(e) {
                 time = new Date().getTime();
             });

             function refresh() {
                 if(new Date().getTime() - time >= 60000) 
                     window.location.reload(true);
                 else 
                     setTimeout(refresh, 10000);
             }

             setTimeout(refresh, 10000);
        </script>
    </head>
    <body>
        <div id="options">
            <h2 tal:content="python: push.repo"></h2>
            <h2 tal:content="python: push.branch"></h2>
            <h2 tal:content="python: push.who"></h2>

            <h2>Commits</h2>
            <tal:commits repeat="commit python: push.data">
                <h3>Message</h3>
                <p tal:content="python: commit['short_commit_msg']"></p>
                <h3>Diff</h3>
                <pre tal:content="structure python: commit['diff']"></pre>
                <h3>Files</h3>
                <tal:files repeat="file python: commit['files']">
                    <p tal:content="file"></p>
                </tal:files>t
            </tal:commits>

            <h2>jenkins results</h2>
            <table class="table">
            <tal:jk repeat="job jobs">
                <tr>
                    <td>
                        <tal:passes condition="python: job['result']==None">
                            <p style="background-color:yellow;">No result</p>
                        </tal:passes>
                        <tal:passes condition="python: job['result'] is True">
                            <p style="background-color:green;">Success</p>
                        </tal:passes>
                        <tal:passes condition="python: job['result'] is False">
                            <p style="background-color:red;">Failure</p>
                        </tal:passes>
                    </td>
                    <td>
                        <p tal:content="python: job['jk_name']"></p>
                    </td>
<!--                     <td>
                        <p tal:content="python: job['jk_uid']"></p>
                    </td>
                    <td>
                        <p tal:content="python: job['date']"></p>
                    </td>
 -->                    <td>
                        <a tal:attributes="href python: job['jk_url']">Go to</a>
                    </td>
                </tr>
            </tal:jk>
            </table>
        </div>
    </body>
</html>
